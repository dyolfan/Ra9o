<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><link href="../../../../../doc/style.css?colorTheme=Custom.OdoTheme" rel="stylesheet" type="text/css" media="all"></head><body><p><a name="top"></a></p><table width="100%"><tr><td style="border: none; text-align: left;"></td><td style="border: none; text-align: right;"></td></tr></table><h1 id="HExtraexercise14:JavaNativeInterface"><span>Extra exercise 14: Java Native Interface</span></h1><ol><li>Review <span class="wikiinternallink"><a href="https://odo.lv/git/JTM/plain/doc/presentations/e14_JNI.odp">presentation</a></span></li><li>Review content of <strong>jtm.extra14</strong> package and <strong>src/main/c/jnifunctions.c</strong> file.</li><li><div><p>Install Gnu C compiler:</p><div class="box"><div class="code">sudo apt-get install gcc</div></div></div></li><li>Implement TODO's for <strong>JNIClass.java</strong> class and <strong>jnifunctions.c</strong> file.</li><li><div><p>Compile <strong>JNIClass.java</strong> file considering classpath and target location:</p><div class="box"><div class="code">javac -cp target/classes src/main/java/jtm/extra14/JNIClass.java</div></div></div></li><li><div><p>Generate <strong>jtm_extra14_JNIClass.h</strong> file in lib folder:</p><div class="box"><div class="code">javah -cp target/classes -d lib/ jtm.extra14.JNIClass</div></div></div></li><li><div><p>Compile <strong>jnifunctions.c</strong> file including JNI libraries for 64-bit Linux:</p><div class="box"><div class="code">gcc -fPIC -I/usr/lib/jvm/java-8-openjdk-amd64/include \<br/>-I/usr/lib/jvm/java-8-openjdk-amd64/include/linux \<br/>./src/main/c/jnifunctions.c -c -o ./lib/jnifunctions.o</div></div></div></li><li><div><p>Make shared library for Linux:</p><div class="box"><div class="code">gcc -shared ./lib/jnifunctions.o -o ./lib/jnifunctions.so</div></div></div></li><li><div><p>Test application by calling its main() method:</p><div class="box"><div class="code">java -cp target/classes/ jtm.extra14.JNIClass</div></div></div></li><li>Ensure <strong>JNIClassTest1.java</strong> unit tests are passing.</li></ol><h2 id="HOptionaltasks"><span>Optional tasks</span></h2><ol><li><div><p>You can compile jnifunctions.c as executable with following parameters:</p><div class="box"><div class="code">gcc -I/usr/lib/jvm/java-8-openjdk-amd64/include \<br/>-I/usr/lib/jvm/java-8-openjdk-amd64/include/linux \<br/>./src/main/c/jnifunctions.c -o ./lib/hello.o</div></div></div></li><li><div><p>Then execute created binary by:</p><div class="box"><div class="code">./lib/hello.o</div></div></div></li></ol><h2 id="HAlternatives"><span>Alternatives</span></h2><ul><li><span class="wikiexternallink"><a href="https://en.wikipedia.org/wiki/Java_Native_Access">Java Native Access (JNA)</a></span></li></ul><p><a name="top"></a></p><table width="100%"><tr><td width="40%" style="border: none; text-align: left;"></td><td width="20%" style="border: none; text-align: center;"><div><p><span class="wikilink"><a href="#top">Up</a></span> <br/> <span class="wikilink"><a href="https://odo.lv/xwiki/bin/view/Training/JavaExerciseExtra">Home</a></span></p></div></td><td style="border: none; text-align: right;"></td></tr></table></body></html>